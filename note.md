# 開発ノート

## 2025.07.03
新たなディレクトリ~/repos/github.com/gacha-masaki作成
仮想環境作成・有効化
必要ファイル準備
パッケージインストール
main.pyでAPIサーバ構築
動作確認
Git管理

## 2025.07.09
Python + FastAPI で作るガチャアプリ
開発環境セットアップ
main.py ... アプリのエントリポイント
gacha_logic.py ... ガチャ抽選ロジック
models.py, schemas.py ... データモデル、スキーマ
test/ ... テストコード
天井機能の追加

## 2025.07.10
### 1. ガチャロジックのテスト追加・強化
- `test_gacha_logic.py` にて正常系・異常系・境界値テストを多数実装。
    - 確率合計が1.0でない場合の例外発生
    - 空リストや負の確率、1超過確率への例外
    - rate=1.0/0.0の挙動
    - ほか極端な値・境界ケースへのテスト
- テストを実行し、エラー内容の分析＆ガチャロジック（`gacha_logic.py`）のエラー処理を修正
    - `ValueError`を適切にraiseするよう修正

### 2. Importエラーの修正
- `main.py`・`test_api.py` の import 文で発生していた `ImportError: cannot import name 'force_s'` を解消
    - `gacha_logic.py` に `force_s` 関数を追加

### 3. FastAPI APIテストの実装・確認
- `test_api.py` で `/gacha/single` `/gacha/ten` などのエンドポイントテストを実装
    - ステータスコード、レスポンスJSON構造、リスト長などを検証

### 4. テストの網羅性チェック・今後の課題整理
- 現状のテストでカバーできている観点・足りない観点を整理
    - 統計的テストや不正なデータ型・構造への異常系テスト追加のアイディアをまとめた


## 2025.07.17
### 1. dependabotで提示されたエラーを修正
- requirements.txtの各種バージョンの修正
それに伴ったエラーの修正

### 2. フロントエンド側とのAPI接続の修正
- CORS設定を追加
フロント（localhost:8080）とバックエンド（localhost:8000）が異なるオリジンなので、APIが許可されていなかったので
CORS（クロスオリジン）エラーを解決するために、バックエンド側にCORS設定を追加した

### 今回の課題
- フロントエンド側との接続面で問題が発生したら随時修正を掛ける